(function(e){function t(t){for(var o,s,l=t[0],c=t[1],u=t[2],d=0,b=[];d<l.length;d++)s=l[d],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&b.push(r[s][0]),r[s]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);i&&i(t);while(b.length)b.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],o=!0,l=1;l<n.length;l++){var c=n[l];0!==r[c]&&(o=!1)}o&&(a.splice(t--,1),e=s(s.s=n[0]))}return e}var o={},r={app:0},a=[];function s(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=o,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(n,o,function(t){return e[t]}.bind(null,o));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],c=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var i=c;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("7a23"),r=n("3fd4"),a=(n("7dd6"),Object(o["l"])("Aside")),s=Object(o["l"])("Header"),l=Object(o["m"])("div",{class:"container"},null,-1);function c(e,t,n,r,c,u){var i=Object(o["K"])("el-aside"),d=Object(o["K"])("el-header"),b=Object(o["K"])("MainShell"),f=Object(o["K"])("el-main"),m=Object(o["K"])("el-container");return Object(o["D"])(),Object(o["i"])(m,null,{default:Object(o["Z"])((function(){return[Object(o["m"])(i,{width:"200px"},{default:Object(o["Z"])((function(){return[a]})),_:1}),Object(o["m"])(m,null,{default:Object(o["Z"])((function(){return[Object(o["m"])(d,null,{default:Object(o["Z"])((function(){return[s]})),_:1}),Object(o["m"])(f,null,{default:Object(o["Z"])((function(){return[Object(o["m"])(b),l]})),_:1})]})),_:1})]})),_:1})}n("b0c0");var u={style:{"margin-bottom":"20px"}},i=Object(o["l"])(" 新建ssh终端 ");function d(e,t,n,r,a,s){var l=Object(o["K"])("el-button"),c=Object(o["K"])("el-tab-pane"),d=Object(o["K"])("el-tabs"),b=Object(o["K"])("NewShell"),f=Object(o["K"])("el-dialog");return Object(o["D"])(),Object(o["i"])(o["b"],null,[Object(o["m"])("div",u,[Object(o["m"])(l,{size:"small",onClick:t[1]||(t[1]=function(e){return s.addTab(a.editableTabsValue)})},{default:Object(o["Z"])((function(){return[i]})),_:1})]),Object(o["m"])(d,{modelValue:a.editableTabsValue,"onUpdate:modelValue":t[2]||(t[2]=function(e){return a.editableTabsValue=e}),type:"card",closable:"",onTabRemove:s.removeTab},{default:Object(o["Z"])((function(){return[(Object(o["D"])(!0),Object(o["i"])(o["b"],null,Object(o["I"])(a.editableTabs,(function(e){return Object(o["D"])(),Object(o["i"])(c,{key:e.name,label:e.title,name:e.name},{default:Object(o["Z"])((function(){return[(Object(o["D"])(),Object(o["i"])(Object(o["M"])(e.content),{wsurl:"ws://localhost:8081/webssh",username:e.username,password:e.password,addr:e.host},null,8,["username","password","addr"]))]})),_:2},1032,["label","name"])})),128))]})),_:1},8,["modelValue","onTabRemove"]),Object(o["m"])(f,{title:"外层 Dialog",modelValue:a.outerVisible,"onUpdate:modelValue":t[3]||(t[3]=function(e){return a.outerVisible=e}),"destroy-on-close":""},{default:Object(o["Z"])((function(){return[Object(o["m"])(b,{onData:s.data},null,8,["onData"])]})),_:1},8,["modelValue"])],64)}n("159b"),n("4de4");var b={ref:"xterm",class:"xterm"};function f(e,t,n,r,a,s){return Object(o["D"])(),Object(o["i"])("div",b,null,512)}n("99af");var m=n("fcf3"),O=(n("abb2"),n("47d0")),h={props:{wsurl:{type:String,default:"ws://localhost:8081/test"},addr:{type:String,default:"localhost:22"},username:{type:String,default:"root"},password:{type:String,default:"Password"}},mounted:function(){this.initTerm(),this.initSocket()},beforeUnmount:function(){this.socket.close(),this.term.dispose()},methods:{initTerm:function(){var e=this;console.log("xterm 初始化");var t=new m["Terminal"]({fontSize:14,cursorBlink:!0}),n=new O["FitAddon"];t.loadAddon(n),n.fit(),this.term=t,console.log(this.term.cols,this.term.rows),this.url="".concat(this.wsurl,"?cols=").concat(this.term.cols,"&rows=").concat(this.term.rows,"&sshaddr=").concat(this.addr,"&sshuser=").concat(this.username,"&sshpassword=").concat(this.password),window.onresize=function(){n.fit()},this.term.onData((function(t){console.log("onData=:",t);var n={type:"cmd",cmd:t};e.socket.send(JSON.stringify(n))})),this.term.onResize((function(t){var n={type:"resize",cols:t.cols,rows:t.rows};console.log(n),e.socket.send(JSON.stringify(n))}))},initSocket:function(){this.socket=new WebSocket(this.url),this.socketOnClose(),this.socketOnOpen(),this.socketOnError(),this.socketOnMessage()},socketOnMessage:function(){var e=this;this.socket.onmessage=function(t){e.term.write(t.data)}},socketOnOpen:function(){var e=this;this.socket.onopen=function(){console.log("socket 连接成功");var t=e.$refs.xterm;e.term.open(t),e.term.focus()}},socketOnClose:function(){this.socket.onclose=function(){console.log("socket 关闭")}},socketOnError:function(){this.socket.onerror=function(){console.log("socket 连接失败")}}}};n("c162");h.render=f;var p=h,j=Object(o["l"])("提交");function v(e,t,n,r,a,s){var l=Object(o["K"])("el-input"),c=Object(o["K"])("el-form-item"),u=Object(o["K"])("el-button"),i=Object(o["K"])("el-form");return Object(o["D"])(),Object(o["i"])(i,{model:e.ruleForm,"status-icon":"",ref:"ruleForm","label-width":"100px",class:"demo-ruleForm"},{default:Object(o["Z"])((function(){return[Object(o["m"])(c,{label:"服务器地址"},{default:Object(o["Z"])((function(){return[Object(o["m"])(l,{autocomplete:"off",modelValue:a.host,"onUpdate:modelValue":t[1]||(t[1]=function(e){return a.host=e})},null,8,["modelValue"])]})),_:1}),Object(o["m"])(c,{label:"用户名"},{default:Object(o["Z"])((function(){return[Object(o["m"])(l,{autocomplete:"off",modelValue:a.username,"onUpdate:modelValue":t[2]||(t[2]=function(e){return a.username=e})},null,8,["modelValue"])]})),_:1}),Object(o["m"])(c,{label:"密码"},{default:Object(o["Z"])((function(){return[Object(o["m"])(l,{type:"password",modelValue:a.password,"onUpdate:modelValue":t[3]||(t[3]=function(e){return a.password=e})},null,8,["modelValue"])]})),_:1}),Object(o["m"])(c,null,{default:Object(o["Z"])((function(){return[Object(o["m"])(u,{type:"primary",onClick:t[4]||(t[4]=function(e){return s.submitForm("ruleForm")})},{default:Object(o["Z"])((function(){return[j]})),_:1})]})),_:1})]})),_:1},8,["model"])}var w={data:function(){return{host:"",username:"",password:""}},methods:{submitForm:function(){var e={host:this.host,username:this.username,password:this.password};this.$emit("data",e)}}};w.render=v;var y=w,g={components:{GoShell:p,NewShell:y},data:function(){return{outerVisible:!1,editableTabsValue:"0",editableTabs:[],tabIndex:0}},methods:{data:function(e){this.outerVisible=!1,console.log(e);var t=++this.tabIndex+"";this.editableTabs.push({host:e.host,title:e.host,name:e.host+t,username:e.username,password:e.password,content:p}),this.editableTabsValue=e.host+t},addTab:function(){this.outerVisible=!0},removeTab:function(e){var t=this.editableTabs,n=this.editableTabsValue;n===e&&t.forEach((function(o,r){if(o.name===e){var a=t[r+1]||t[r-1];a&&(n=a.name)}})),this.editableTabsValue=n,this.editableTabs=t.filter((function(t){return t.name!==e}))}}};g.render=d;var k=g,V={name:"App",components:{MainShell:k}};V.render=c;var T=V,_=Object(o["h"])(T);_.use(r["a"]),_.mount("#app")},c162:function(e,t,n){"use strict";n("d560")},d560:function(e,t,n){}});
//# sourceMappingURL=app.968ff97c.js.map